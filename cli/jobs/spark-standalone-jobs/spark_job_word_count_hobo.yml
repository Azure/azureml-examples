$schema: http://azureml/sdk-2-0/SparkComponent.json

type: spark
code: ./spark_job_word_count/src
description: "Submit a spark job to count words"
environment: azureml:condaenv:1
resources:
  instance_type: standard_e8s_v3
  runtime_version: 3.2
entry:
  file: wordcount.py
inputs:
  input1:
    type: uri_file
    path: ./spark_job_word_count/datasets/simpleshakespeare.txt
    mode: direct
conf:
  spark.driver.cores: 1
  spark.driver.memory: 2g
  spark.executor.cores: 2
  spark.executor.memory: 2g
  spark.executor.instances: 2
  spark.dynamicAllocation.enabled: True
  spark.dynamicAllocation.minExecutors: 1
  spark.dynamicAllocation.maxExecutors: 3
args: --input1 ${{inputs.input1}}
identity:
  type: user_identity
