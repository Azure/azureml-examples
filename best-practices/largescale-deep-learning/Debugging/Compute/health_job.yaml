# Training job submission via AzureML CLI v2
$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json

# command: sudo -E bash temp_script.sh && python run_nhc.py
command: apt-get update -y && apt-get install python3.10 python3-pip -y && pip install requests && python3 run_nhc.py
code: .
environment: 
  image: aznhc.azurecr.io/nvrt
experiment_name: Node-Health-Checks
compute: low-pri-nc24s
distribution:
  type: pytorch
  process_count_per_instance: 1
resources:
  instance_count: 1
  docker_args: --volume=/var/log/syslog:/azure-nhc/syslog
environment_variables:
  # -d for debug, -v for verbose, -a for all (to run all checks even if some fail)
  NHC_ARGS: -v -d -a
  AZ_NHC_ROOT: /azure-nhc/