name: cli-jobs-single-step-gpu_perf-gpu_perf_job-amlarc
on:
  workflow_dispatch:
    inputs:
      SUBSCRIPTION:
        description: Subscription ID
        required: false
        default: 6560575d-fa06-4e7d-95fb-f962e74efd7a
      RESOURCE_GROUP:
        description: Resource Group
        required: false
        default: azureml-examples-rg
      WORKSPACE:
        description: Workspace Name
        required: false
        default: amlarc-githubtest-ws
  schedule:
  - cron: 0 0/4 * * *
  pull_request:
    branches:
    - main
    paths:
    - cli/jobs/single-step/gpu_perf/**
    - .github/workflows/cli-jobs-single-step-gpu_perf-gpu_perf_job.yml
    - cli/setup.sh
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: check out repo
      uses: actions/checkout@v2
    - name: azure login
      uses: azure/login@v1
      with:
        creds: ${{secrets.AZ_CREDS}}
    - name: setup
      run: bash setup.sh
      working-directory: cli
      continue-on-error: true
    - name: run job
      run: bash -x run-job.sh jobs/single-step/gpu_perf/gpu_perf_job.yml
      working-directory: cli
    env:
      SUBSCRIPTION: ${{ github.event.inputs.SUBSCRIPTION }}
      RESOURCE_GROUP: ${{ github.event.inputs.RESOURCE_GROUP }}
      WORKSPACE: ${{ github.event.inputs.WORKSPACE }}
