name: cli-jobs-single-step-tensorflow-mnist-job-amlarc
on:
  workflow_dispatch:
    inputs:
      SUBSCRIPTION:
        description: Subscription ID
        required: false
        default: 6560575d-fa06-4e7d-95fb-f962e74efd7a
      RESOURCE_GROUP:
        description: Resource Group
        required: false
        default: azureml-examples-rg
      WORKSPACE:
        description: Workspace Name
        required: false
        default: amlarc-githubtest-ws
  schedule:
  - cron: 0 0/4 * * *
  pull_request:
    branches:
    - main
    - sdk-preview
    paths:
    - cli/jobs/single-step/tensorflow/mnist/**
    - .github/workflows/cli-jobs-single-step-tensorflow-mnist-job-amlarc.yml
    - .github/amlarc-tool.sh
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: check out repo
      uses: actions/checkout@v2
    - name: setup python
      uses: actions/setup-python@v2
      with:
        python-version: '3.8'
    - name: install tools
      run: bash .github/amlarc-tool.sh install_tools
      timeout-minutes: 30
    - name: azure login
      uses: azure/login@v1
      with:
        creds: ${{secrets.AZ_AE_CREDS}}
      timeout-minutes: 30
    - name: run job
      run: bash ../../../../../.github/amlarc-tool.sh run_cli_job job.yml -cr
      working-directory: cli/jobs/single-step/tensorflow/mnist
    env:
      SUBSCRIPTION: ${{ github.event.inputs.SUBSCRIPTION }}
      RESOURCE_GROUP: ${{ github.event.inputs.RESOURCE_GROUP }}
      WORKSPACE: ${{ github.event.inputs.WORKSPACE }}
